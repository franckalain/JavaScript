WEBVTT

00:00.660 --> 00:04.770
We need to calculate the average rating for each product.

00:04.770 --> 00:11.310
In this video we will learn how to calculate average reading with the help of a function by mongoose

00:11.310 --> 00:13.030
called virtualise.

00:13.110 --> 00:19.050
The first thing we need to do is we need to add a Nunley attributes to our product schema which are

00:19.260 --> 00:21.690
the virtual objects that go ahead and do that.

00:21.690 --> 00:23.040
So it a good product.

00:23.140 --> 00:23.940
Yes.

00:24.270 --> 00:29.440
And here you want to do two object

00:47.210 --> 00:49.350
in order for the average rating to show up.

00:49.400 --> 00:58.490
We need to add these two objects two object and two Jaison virtual Is that something that is not stored

00:58.790 --> 01:00.150
in our database.

01:00.170 --> 01:06.680
So whenever someone called the product API it will actually Cockley the every rating on the go but not

01:06.680 --> 01:09.470
going to save it to the database.

01:09.530 --> 01:12.010
So let's go ahead and do that.

01:12.300 --> 01:14.980
We go here and do all of our

01:21.760 --> 02:17.820
We're going to do everything right thing Get on the dead or you do this use Lang zero.

02:18.720 --> 02:22.380
So we are using get because we we're not setting anything.

02:22.440 --> 02:25.740
We are simply getting the reviews from the database.

02:25.740 --> 02:32.820
So what is going on is first we give the Virtual a name which is average rating then we do some easy

02:32.820 --> 02:34.110
math calculation.

02:34.440 --> 02:37.410
So then we set the rating to zero.

02:37.440 --> 02:44.610
The first is is you know if the land area of review is equal to zero then we want to set the rating

02:44.610 --> 02:48.670
to zero because there are no reviews at all else.

02:48.810 --> 02:56.990
We want to do a math function to the rave reviews and we are simply getting each of you rating and we

02:56.990 --> 03:01.400
simply just keep adding it to the rating variable.

03:01.430 --> 03:13.010
For example if B for example if the area has 5 3 2 and 2 the rating variable would be equivalent to

03:13.070 --> 03:20.300
12 and final thing finally finally is we want to Cockley average rating.

03:20.650 --> 03:29.580
So what we're doing is is we just divide the ratings with the laying of the area.

03:29.590 --> 03:32.800
So let's see the rating is 12.

03:33.080 --> 03:33.790
Right.

03:33.850 --> 03:37.860
And then you want to divide it by one 2 three and four.

03:38.260 --> 03:40.910
So the rating will be good to read.

03:41.440 --> 03:43.720
So simple as that.

03:46.380 --> 03:54.050
Let us set up so was good to postman and currently the reviews is not showing any errors reading.

03:54.450 --> 04:03.810
So it go ahead and send one more time and it's not showing you every screen to go back to code.

04:03.850 --> 04:05.660
And let's check what if we do anything wrong.

04:05.670 --> 04:10.840
I'm supposed to do average grading of Jack G.

04:10.950 --> 04:14.670
Supposed to be all capital right.

04:16.230 --> 04:20.220
See this is good but we're both show and check what it is.

04:20.220 --> 04:22.010
No problem not there's no problems.

04:22.020 --> 04:29.620
Go back to postman and send And now we have average waiting five.

04:29.640 --> 04:30.310
Awesome.

04:30.590 --> 04:32.630
So go in and add another review.

04:32.660 --> 04:35.690
So it's not just me kid country.

04:35.720 --> 04:36.430
All right.

04:36.800 --> 04:41.550
So go and send successfully edit to review.

04:41.580 --> 04:45.190
Let's go back to the step and let's go ahead and send it again

04:48.100 --> 04:54.320
and boom we have it and then we have four because you know the preview the first review was five.

04:54.430 --> 04:58.550
If you take a look here five The second is tree.

04:58.720 --> 05:03.200
So five plus three of them to eat and eat divided by two of them to four.

05:03.370 --> 05:05.690
So we have the average rating.

05:05.950 --> 05:06.940
Awesome.

05:07.030 --> 05:12.820
In this video we learn how to Cockley the average rating of each product using mongoose function called

05:12.850 --> 05:13.990
virtual.

05:13.990 --> 05:20.710
In the next section Adam Peterson will walk through the posting review and show the review on the front

05:20.710 --> 05:21.640
end part.

05:22.040 --> 05:24.290
I'll see you guys in the next section.
